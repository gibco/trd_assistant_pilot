<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Asistente Inteligente TRD - Piloto </title>
    <style>
        :root {
            --primary-color: #00539B;
            --secondary-color: #DD6E42;
            --accent-color: #4C9F70;
            --light-color: #f8f9fa;
            --dark-color: #212529;
            --gray-color: #6c757d;
            --border-color: #dee2e6;
            --success-color: #28a745;
            --warning-color: #ffc107;
            --error-color: #dc3545;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: var(--dark-color);
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }
        
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 20px;
        }
        
        .header {
            text-align: center;
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        
        .header h1 {
            color: var(--primary-color);
            font-size: 2.5rem;
            margin-bottom: 10px;
            background: linear-gradient(45deg, var(--primary-color), var(--secondary-color));
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }
        
        .header p {
            color: var(--gray-color);
            font-size: 1.1rem;
        }
        
        .main-content {
            display: grid;
            grid-template-columns: 1fr 350px;
            gap: 30px;
            height: calc(100vh - 200px);
        }
        
        .chat-container {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            display: flex;
            flex-direction: column;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
            overflow: hidden;
        }
        
        .chat-header {
            background: linear-gradient(45deg, var(--primary-color), var(--accent-color));
            color: white;
            padding: 20px;
            text-align: center;
        }
        
        .chat-header h2 {
            margin: 0;
            font-size: 1.5rem;
        }
        
        .chat-messages {
            flex: 1;
            padding: 20px;
            overflow-y: auto;
            max-height: 500px;
        }
        
        .message {
            margin-bottom: 15px;
            display: flex;
            align-items: flex-start;
            gap: 10px;
        }
        
        .message.user {
            flex-direction: row-reverse;
        }
        
        .message-avatar {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            color: white;
            font-size: 0.9rem;
        }
        
        .message.user .message-avatar {
            background: var(--secondary-color);
        }
        
        .message.assistant .message-avatar {
            background: var(--primary-color);
        }
        
        .message-content {
            background: #f8f9fa;
            padding: 15px;
            border-radius: 15px;
            max-width: 70%;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
        }
        
        .message.user .message-content {
            background: var(--secondary-color);
            color: white;
        }
        
        .message.assistant .message-content {
            background: white;
            border: 1px solid var(--border-color);
        }
        
        .chat-input {
            padding: 20px;
            border-top: 1px solid var(--border-color);
            background: white;
        }
        
        .input-group {
            display: flex;
            gap: 10px;
        }
        
        .chat-input input {
            flex: 1;
            padding: 12px 15px;
            border: 2px solid var(--border-color);
            border-radius: 25px;
            font-size: 1rem;
            outline: none;
            transition: border-color 0.3s ease;
        }
        
        .chat-input input:focus {
            border-color: var(--primary-color);
        }
        
        .send-btn {
            padding: 12px 20px;
            background: linear-gradient(45deg, var(--primary-color), var(--accent-color));
            color: white;
            border: none;
            border-radius: 25px;
            cursor: pointer;
            font-weight: bold;
            transition: transform 0.2s ease;
        }
        
        .send-btn:hover {
            transform: translateY(-2px);
        }
        
        .send-btn:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            transform: none;
        }
        
        .sidebar {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .panel {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(10px);
            border-radius: 15px;
            padding: 20px;
            box-shadow: 0 8px 32px rgba(0, 0, 0, 0.1);
        }
        
        .panel h3 {
            color: var(--primary-color);
            margin-bottom: 15px;
            font-size: 1.2rem;
        }
        
        .quick-actions {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .action-btn {
            padding: 10px 15px;
            background: linear-gradient(45deg, var(--accent-color), var(--primary-color));
            color: white;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 0.9rem;
            transition: transform 0.2s ease;
        }
        
        .action-btn:hover {
            transform: translateY(-1px);
        }
        
        .stats {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
        }
        
        .stat-item {
            text-align: center;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-radius: 10px;
        }
        
        .stat-number {
            font-size: 1.5rem;
            font-weight: bold;
            display: block;
        }
        
        .stat-label {
            font-size: 0.8rem;
            opacity: 0.9;
        }
        
        .examples {
            list-style: none;
        }
        
        .examples li {
            padding: 8px 0;
            border-bottom: 1px solid #eee;
            cursor: pointer;
            transition: color 0.3s ease;
        }
        
        .examples li:hover {
            color: var(--primary-color);
        }
        
        .examples li:last-child {
            border-bottom: none;
        }
        
        .typing {
            display: flex;
            align-items: center;
            gap: 5px;
            color: var(--gray-color);
            font-style: italic;
        }
        
        .typing-dots {
            display: flex;
            gap: 3px;
        }
        
        .typing-dot {
            width: 6px;
            height: 6px;
            background: var(--gray-color);
            border-radius: 50%;
            animation: typing 1.4s infinite;
        }
        
        .typing-dot:nth-child(2) {
            animation-delay: 0.2s;
        }
        
        .typing-dot:nth-child(3) {
            animation-delay: 0.4s;
        }
        
        @keyframes typing {
            0%, 60%, 100% {
                transform: translateY(0);
                opacity: 0.3;
            }
            30% {
                transform: translateY(-10px);
                opacity: 1;
            }
        }
        
        .confidence-indicator {
            display: inline-block;
            padding: 3px 8px;
            border-radius: 12px;
            font-size: 0.8rem;
            font-weight: bold;
            margin-left: 10px;
        }
        
        .confidence-high {
            background: var(--success-color);
            color: white;
        }
        
        .confidence-medium {
            background: var(--warning-color);
            color: var(--dark-color);
        }
        
        .confidence-low {
            background: var(--error-color);
            color: white;
        }
        
        .citation {
            font-size: 0.8rem;
            color: var(--gray-color);
            margin-top: 8px;
            padding-top: 8px;
            border-top: 1px solid #eee;
        }
        
        .highlight {
            background: linear-gradient(120deg, transparent 0%, transparent 50%, #ffeb3b 50%, #ffeb3b 100%);
            background-size: 220% 100%;
            animation: highlight 2s ease-in-out;
        }
        
        @keyframes highlight {
            0% {
                background-position: 100% 0;
            }
            100% {
                background-position: 0 0;
            }
        }
        
        @media (max-width: 1024px) {
            .main-content {
                grid-template-columns: 1fr;
                gap: 20px;
            }
            
            .sidebar {
                order: -1;
            }
            
            .stats {
                grid-template-columns: repeat(4, 1fr);
            }
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 10px;
            }
            
            .header h1 {
                font-size: 2rem;
            }
            
            .stats {
                grid-template-columns: 1fr 1fr;
            }
            
            .message-content {
                max-width: 85%;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>ü§ñ Asistente Inteligente TRD</h1>
            <p>Piloto de Interpretaci√≥n Automatizada de Tablas de Retenci√≥n Documental</p>
            <p><strong>Piloto</strong></p>
        </div>
        
        <div class="main-content">
            <div class="chat-container">
                <div class="chat-header">
                    <h2>üí¨ Consulta tu TRD</h2>
                    <p>Haz preguntas sobre series documentales, tiempos de retenci√≥n y disposici√≥n final</p>
                </div>
                
                <div class="chat-messages" id="chatMessages">
                    <div class="message assistant">
                        <div class="message-avatar">IA</div>
                        <div class="message-content">
                            <p>¬°Hola! Soy tu asistente para consultas sobre Tablas de Retenci√≥n Documental. Puedo ayudarte con:</p>
                            <ul style="margin: 10px 0; padding-left: 20px;">
                                <li>Buscar series y subseries documentales</li>
                                <li>Consultar tiempos de retenci√≥n</li>
                                <li>Verificar disposici√≥n final</li>
                                <li>Explicar normativa archiv√≠stica</li>
                            </ul>
                            <p>¬øEn qu√© puedo ayudarte hoy?</p>
                            <span class="confidence-indicator confidence-high">Sistema listo</span>
                        </div>
                    </div>
                </div>
                
                <div class="chat-input">
                    <div class="input-group">
                        <input type="text" id="userInput" placeholder="Escribe tu consulta sobre TRD aqu√≠..." maxlength="500">
                        <button class="send-btn" onclick="sendMessage()" id="sendBtn">Enviar</button>
                    </div>
                </div>
            </div>
            
            <div class="sidebar">
                <div class="panel">
                    <h3>üìä Estado del Sistema</h3>
                    <div class="stats">
                        <div class="stat-item">
                            <span class="stat-number">248</span>
                            <span class="stat-label">Series TRD</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number">156</span>
                            <span class="stat-label">Subseries</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number">98%</span>
                            <span class="stat-label">Precisi√≥n</span>
                        </div>
                        <div class="stat-item">
                            <span class="stat-number">1.2s</span>
                            <span class="stat-label">Resp. Prom.</span>
                        </div>
                    </div>
                </div>
                
                <div class="panel">
                    <h3>‚ö° Acciones R√°pidas</h3>
                    <div class="quick-actions">
                        <button class="action-btn" onclick="quickQuery('¬øCu√°les son las series de archivo de gesti√≥n?')">
                            üìÅ Series de Gesti√≥n
                        </button>
                        <button class="action-btn" onclick="quickQuery('¬øQu√© documentos tienen conservaci√≥n total?')">
                            üõ°Ô∏è Conservaci√≥n Total
                        </button>
                        <button class="action-btn" onclick="quickQuery('Expl√≠came los tiempos de retenci√≥n en archivo central')">
                            ‚è±Ô∏è Tiempos Retenci√≥n
                        </button>
                        <button class="action-btn" onclick="quickQuery('¬øQu√© significa eliminaci√≥n por digitalizaci√≥n?')">
                            üóëÔ∏è Disposici√≥n Final
                        </button>
                    </div>
                </div>
                
                <div class="panel">
                    <h3>üí° Ejemplos de Consultas</h3>
                    <ul class="examples">
                        <li onclick="quickQuery('¬øCu√°nto tiempo debo conservar las actas de comit√©?')">
                            Tiempo de conservaci√≥n de actas
                        </li>
                        <li onclick="quickQuery('Busca la serie Comunicaciones Oficiales')">
                            Buscar serie espec√≠fica
                        </li>
                        <li onclick="quickQuery('¬øQu√© documentos van a archivo hist√≥rico?')">
                            Documentos archivo hist√≥rico
                        </li>
                        <li onclick="quickQuery('Explica la diferencia entre CT y E')">
                            Diferencia CT vs E
                        </li>
                        <li onclick="quickQuery('¬øCu√°l es el marco normativo para TRD?')">
                            Marco normativo TRD
                        </li>
                    </ul>
                </div>
                
                <div class="panel">
                    <h3>üìã Informaci√≥n del Piloto</h3>
                    <p><strong>Versi√≥n:</strong> 1.0 (Piloto)</p>
                    <p><strong>Dataset:</strong> TRD Institucional 2024</p>
                    <p><strong>Modelo:</strong> GPT-4 + RAG</p>
                    <p><strong>√öltima actualizaci√≥n:</strong> Enero 2025</p>
                    <p style="font-size: 0.8rem; color: var(--gray-color); margin-top: 10px;">
                        ‚ö†Ô∏è Este es un sistema piloto para demostraci√≥n. Las respuestas deben ser validadas por personal archiv√≠stico.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Simulaci√≥n de base de datos TRD
        const trdDatabase = {
            series: [
                {
                    codigo: "100",
                    serie: "Actas de Comit√©",
                    subserie: "Actas de Comit√© Directivo",
                    retencionAG: "5 a√±os",
                    retencionAC: "10 a√±os",
                    disposicionFinal: "CT",
                    procedimiento: "Transferir al Archivo Hist√≥rico",
                    normativa: "Ley 594 de 2000, Acuerdo AGN 004 de 2019"
                },
                {
                    codigo: "200",
                    serie: "Comunicaciones Oficiales",
                    subserie: "Correspondencia Enviada",
                    retencionAG: "2 a√±os",
                    retencionAC: "8 a√±os",
                    disposicionFinal: "E",
                    procedimiento: "Eliminaci√≥n",
                    normativa: "Ley 594 de 2000"
                },
                {
                    codigo: "300",
                    serie: "Contratos",
                    subserie: "Contratos de Prestaci√≥n de Servicios",
                    retencionAG: "3 a√±os",
                    retencionAC: "17 a√±os",
                    disposicionFinal: "CT",
                    procedimiento: "Transferir al Archivo Hist√≥rico",
                    normativa: "C√≥digo Civil, Ley 594 de 2000"
                },
                {
                    codigo: "400",
                    serie: "Informes de Gesti√≥n",
                    subserie: "Informes Anuales",
                    retencionAG: "2 a√±os",
                    retencionAC: "28 a√±os",
                    disposicionFinal: "CT",
                    procedimiento: "Transferir al Archivo Hist√≥rico",
                    normativa: "Ley 594 de 2000, Acuerdo AGN 004 de 2019"
                }
            ],
            glosario: {
                "CT": "Conservaci√≥n Total - Los documentos deben conservarse permanentemente por su valor hist√≥rico",
                "E": "Eliminaci√≥n - Los documentos pueden ser eliminados una vez cumplidos los tiempos de retenci√≥n",
                "AG": "Archivo de Gesti√≥n - Primera fase del archivo donde se conservan documentos activos",
                "AC": "Archivo Central - Segunda fase donde se transfieren documentos semiactivos",
                "TRD": "Tabla de Retenci√≥n Documental - Instrumento que establece los tiempos de permanencia de los documentos"
            }
        };

        let messageCount = 0;

        function sendMessage() {
            const input = document.getElementById('userInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            addMessage(message, 'user');
            input.value = '';
            
            // Simular procesamiento
            showTyping();
            setTimeout(() => {
                hideTyping();
                processQuery(message);
            }, 1500 + Math.random() * 1000);
        }

        function quickQuery(query) {
            document.getElementById('userInput').value = query;
            sendMessage();
        }

        function addMessage(content, sender) {
            const messagesContainer = document.getElementById('chatMessages');
            const messageDiv = document.createElement('div');
            messageDiv.className = `message ${sender}`;
            
            const avatar = document.createElement('div');
            avatar.className = 'message-avatar';
            avatar.textContent = sender === 'user' ? 'T√ö' : 'IA';
            
            const messageContent = document.createElement('div');
            messageContent.className = 'message-content';
            messageContent.innerHTML = content;
            
            messageDiv.appendChild(avatar);
            messageDiv.appendChild(messageContent);
            
            messagesContainer.appendChild(messageDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
            
            // A√±adir efecto de highlight
            messageContent.classList.add('highlight');
            setTimeout(() => messageContent.classList.remove('highlight'), 2000);
        }

        function showTyping() {
            const messagesContainer = document.getElementById('chatMessages');
            const typingDiv = document.createElement('div');
            typingDiv.className = 'message assistant';
            typingDiv.id = 'typingIndicator';
            
            typingDiv.innerHTML = `
                <div class="message-avatar">IA</div>
                <div class="message-content">
                    <div class="typing">
                        <span>Analizando TRD</span>
                        <div class="typing-dots">
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                            <div class="typing-dot"></div>
                        </div>
                    </div>
                </div>
            `;
            
            messagesContainer.appendChild(typingDiv);
            messagesContainer.scrollTop = messagesContainer.scrollHeight;
        }

        function hideTyping() {
            const typing = document.getElementById('typingIndicator');
            if (typing) typing.remove();
        }

        function processQuery(query) {
            const response = generateResponse(query);
            addMessage(response, 'assistant');
            messageCount++;
            
            // Actualizar estad√≠sticas
            document.querySelector('.stat-number').textContent = 248 + messageCount;
        }

        function generateResponse(query) {
            const lowerQuery = query.toLowerCase();
            
            // B√∫squeda de series espec√≠ficas
            if (lowerQuery.includes('actas') || lowerQuery.includes('comit√©')) {
                const serie = trdDatabase.series.find(s => s.serie.toLowerCase().includes('actas'));
                return `
                    <p><strong>üìã Serie encontrada: ${serie.serie}</strong></p>
                    <ul>
                        <li><strong>C√≥digo:</strong> ${serie.codigo}</li>
                        <li><strong>Subserie:</strong> ${serie.subserie}</li>
                        <li><strong>Retenci√≥n AG:</strong> ${serie.retencionAG}</li>
                        <li><strong>Retenci√≥n AC:</strong> ${serie.retencionAC}</li>
                        <li><strong>Disposici√≥n Final:</strong> ${serie.disposicionFinal} (${trdDatabase.glosario[serie.disposicionFinal]})</li>
                    </ul>
                    <div class="citation">
                        <strong>Marco normativo:</strong> ${serie.normativa}
                    </div>
                    <span class="confidence-indicator confidence-high">Confianza: 95%</span>
                `;
            }
            
            if (lowerQuery.includes('comunicaciones') || lowerQuery.includes('correspondencia')) {
                const serie = trdDatabase.series.find(s => s.serie.toLowerCase().includes('comunicaciones'));
                return `
                    <p><strong>üìß Serie encontrada: ${serie.serie}</strong></p>
                    <ul>
                        <li><strong>C√≥digo:</strong> ${serie.codigo}</li>
                        <li><strong>Subserie:</strong> ${serie.subserie}</li>
                        <li><strong>Retenci√≥n AG:</strong> ${serie.retencionAG}</li>
                        <li><strong>Retenci√≥n AC:</strong> ${serie.retencionAC}</li>
                        <li><strong>Disposici√≥n Final:</strong> ${serie.disposicionFinal} (${trdDatabase.glosario[serie.disposicionFinal]})</li>
                    </ul>
                    <div class="citation">
                        <strong>Marco normativo:</strong> ${serie.normativa}
                    </div>
                    <span class="confidence-indicator confidence-high">Confianza: 92%</span>
                `;
            }
            
            if (lowerQuery.includes('conservaci√≥n total') || lowerQuery.includes('ct')) {
                const seriesCT = trdDatabase.series.filter(s => s.disposicionFinal === 'CT');
                return `
                    <p><strong>üõ°Ô∏è Documentos con Conservaci√≥n Total (CT):</strong></p>
                    <ul>
                        ${seriesCT.map(s => `<li><strong>${s.serie}:</strong> ${s.subserie}</li>`).join('')}
                    </ul>
                    <p><strong>üìñ Definici√≥n CT:</strong> ${trdDatabase.glosario.CT}</p>
                    <p>Estos documentos deben transferirse al archivo hist√≥rico y conservarse permanentemente debido a su valor testimonial, hist√≥rico o cultural.</p>
                    <span class="confidence-indicator confidence-high">Confianza: 98%</span>
                `;
            }
            
            if (lowerQuery.includes('eliminaci√≥n') || lowerQuery.includes('disposici√≥n final')) {
                return `
                    <p><strong>üóëÔ∏è Disposici√≥n Final en TRD:</strong></p>
                    <ul>
                        <li><strong>CT (Conservaci√≥n Total):</strong> ${trdDatabase.glosario.CT}</li>
                        <li><strong>E (Eliminaci√≥n):</strong> ${trdDatabase.glosario.E}</li>
                    </ul>
                    <p><strong>‚ö†Ô∏è Importante:</strong> La eliminaci√≥n de documentos debe seguir el procedimiento establecido en el Acuerdo AGN 004 de 2019, con previa aprobaci√≥n del Comit√© de Archivo y elaboraci√≥n del acta correspondiente.</p>
                    <div class="citation">
                        <strong>Referencias:</strong> Ley 594 de 2000, Art. 22; Acuerdo AGN 004 de 2019
                    </div>
                    <span class="confidence-indicator confidence-high">Confianza: 97%</span>
                `;
            }
            
            if (lowerQuery.includes('archivo hist√≥rico') || lowerQuery.includes('transferencia')) {
                const seriesCT = trdDatabase.series.filter(s => s.disposicionFinal === 'CT');
                return `
                    <p><strong>üèõÔ∏è Documentos que van al Archivo Hist√≥rico:</strong></p>
                    <p>Los documentos con disposici√≥n final <strong>CT (Conservaci√≥n Total)</strong> deben transferirse al archivo hist√≥rico:</p>
                    <ul>
                        ${seriesCT.map(s => `<li>${s.serie} - ${s.subserie}</li>`).join('')}
                    </ul>
                    <p><strong>üìÖ Cronograma:</strong> Las transferencias se realizan una vez cumplidos los tiempos de retenci√≥n en archivo central.</p>
                    <p><strong>üìã Procedimiento:</strong> Elaborar inventario documental, solicitar autorizaci√≥n y coordinar con el archivo hist√≥rico receptor.</p>
                    <span class="confidence-indicator confidence-medium">Confianza: 89%</span>
                `;
            }
            
            if (lowerQuery.includes('tiempo') || lowerQuery.includes('retenci√≥n') || lowerQuery.includes('conservar')) {
                return `
                    <p><strong>‚è±Ô∏è Tiempos de Retenci√≥n en TRD:</strong></p>
                    <ul>
                        <li><strong>Archivo de Gesti√≥n (AG):</strong> Tiempo durante el cual los documentos permanecen en la oficina productora para consulta frecuente</li>
                        <li><strong>Archivo Central (AC):</strong> Tiempo en que los documentos se conservan para consulta espor√°dica</li>
                    </ul>
                    <p><strong>üìä Ejemplos de nuestra TRD:</strong></p>
                    <ul>
                        <li>Actas de Comit√©: AG 5 a√±os + AC 10 a√±os = 15 a√±os total</li>
                        <li>Correspondencia: AG 2 a√±os + AC 8 a√±os = 10 a√±os total</li>
                        <li>Contratos: AG 3 a√±os + AC 17 a√±os = 20 a√±os total</li>
                    </ul>
                    <div class="citation">
                        <strong>Fundamento legal:</strong> Los tiempos se establecen seg√∫n el Acuerdo AGN 004 de 2019 y la normativa espec√≠fica de cada tipo documental
                    </div>
                    <span class="confidence-indicator confidence-high">Confianza: 94%</span>
                `;
            }
            
            if (lowerQuery.includes('normativa') || lowerQuery.includes('marco legal') || lowerQuery.includes('ley')) {
                return `
                    <p><strong>üìö Marco Normativo para TRD:</strong></p>
                    <ul>
                        <li><strong>Ley 594 de 2000:</strong> Ley General de Archivos de Colombia</li>
                        <li><strong>Acuerdo AGN 004 de 2019:</strong> Reglamentos para la elaboraci√≥n de TRD y TVD</li>
                        <li><strong>Acuerdo AGN 027 de 2006:</strong> Procedimientos para la elaboraci√≥n de TRD</li>
                        <li><strong>Decreto 1080 de 2015:</strong> Decreto √önico Reglamentario del Sector Cultura</li>
                        <li><strong>ISO 15489:</strong> Norma internacional para gesti√≥n de documentos</li>
                    </ul>
                    <p><strong>üéØ Aplicaci√≥n:</strong> Las TRD deben elaborarse siguiendo estos lineamientos y ser convalidadas por el AGN antes de su implementaci√≥n.</p>
                    <div class="citation">
                        <strong>Consulta adicional:</strong> www.archivogeneral.gov.co
                    </div>
                    <span class="confidence-indicator confidence-high">Confianza: 99%</span>
                `;
            }
            
            if (lowerQuery.includes('diferencia') && (lowerQuery.includes('ct') || lowerQuery.includes('e'))) {
                return `
                    <p><strong>üîç Diferencia entre CT y E:</strong></p>
                    <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 15px 0;">
                        <div style="background: #e8f5e8; padding: 15px; border-radius: 8px;">
                            <h4 style="color: #2d5a2d; margin: 0 0 10px 0;">CT - Conservaci√≥n Total</h4>
                            <ul style="margin: 0;">
                                <li>Valor permanente</li>
                                <li>Transferencia al archivo hist√≥rico</li>
                                <li>Conservaci√≥n indefinida</li>
                                <li>Acceso para investigaci√≥n</li>
                            </ul>
                        </div>
                        <div style="background: #ffe8e8; padding: 15px; border-radius: 8px;">
                            <h4 style="color: #5a2d2d; margin: 0 0 10px 0;">E - Eliminaci√≥n</h4>
                            <ul style="margin: 0;">
                                <li>Sin valor permanente</li>
                                <li>Eliminaci√≥n controlada</li>
                                <li>Cumplidos los tiempos</li>
                                <li>Acta de eliminaci√≥n</li>
                            </ul>
                        </div>
                    </div>
                    <p><strong>‚öñÔ∏è Criterios de decisi√≥n:</strong> Valor administrativo, legal, fiscal, contable, t√©cnico, hist√≥rico y cultural del documento.</p>
                    <span class="confidence-indicator confidence-high">Confianza: 96%</span>
                `;
            }

            // B√∫squeda de series de gesti√≥n
            if (lowerQuery.includes('series de gesti√≥n') || lowerQuery.includes('archivo de gesti√≥n')) {
                return `
                    <p><strong>üìÅ Series en Archivo de Gesti√≥n:</strong></p>
                    <p>Todas las series documentales inician en el archivo de gesti√≥n. Aqu√≠ est√°n las principales de nuestra TRD:</p>
                    <ul>
                        ${trdDatabase.series.map(s => `
                            <li><strong>${s.codigo} - ${s.serie}:</strong> ${s.retencionAG} en AG</li>
                        `).join('')}
                    </ul>
                    <p><strong>üí° Recordatorio:</strong> Los documentos en archivo de gesti√≥n son de consulta frecuente y est√°n bajo responsabilidad de la oficina productora.</p>
                    <div class="citation">
                        <strong>Definici√≥n:</strong> Acuerdo AGN 004 de 2019, Art. 3
                    </div>
                    <span class="confidence-indicator confidence-high">Confianza: 91%</span>
                `;
            }

            // Respuesta por defecto con sugerencias inteligentes
            return `
                <p><strong>ü§î No encontr√© informaci√≥n espec√≠fica sobre "${query}"</strong></p>
                <p>Como asistente de TRD, puedo ayudarte con:</p>
                <ul>
                    <li>üîç <strong>B√∫squeda de series:</strong> "Busca la serie Contratos" o "¬øD√≥nde est√° la subserie de Correspondencia?"</li>
                    <li>‚è±Ô∏è <strong>Tiempos de retenci√≥n:</strong> "¬øCu√°nto tiempo conservo las actas?" o "Tiempos de retenci√≥n de informes"</li>
                    <li>üìã <strong>Disposici√≥n final:</strong> "¬øQu√© documentos van a archivo hist√≥rico?" o "Explica CT vs E"</li>
                    <li>üìö <strong>Normativa:</strong> "¬øCu√°l es el marco legal de las TRD?"</li>
                </ul>
                <p><strong>üí≠ Sugerencia:</strong> Intenta ser m√°s espec√≠fico en tu consulta o usa alguno de los ejemplos de la barra lateral.</p>
                <span class="confidence-indicator confidence-low">Confianza: 45%</span>
            `;
        }

        // Event listeners
        document.getElementById('userInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });

        // Simular actualizaciones en tiempo real
        setInterval(() => {
            const precision = document.querySelectorAll('.stat-number')[2];
            const currentValue = parseInt(precision.textContent);
            const newValue = Math.max(95, Math.min(99, currentValue + (Math.random() - 0.5) * 2));
            precision.textContent = Math.round(newValue) + '%';
        }, 10000);

        // Funcionalidad adicional para demostraci√≥n
        function exportConversation() {
            const messages = document.querySelectorAll('.message');
            let conversation = 'Conversaci√≥n con Asistente TRD\n';
            conversation += '================================\n\n';
            
            messages.forEach((msg, index) => {
                const sender = msg.classList.contains('user') ? 'Usuario' : 'Asistente IA';
                const content = msg.querySelector('.message-content').innerText;
                conversation += `${sender}: ${content}\n\n`;
            });
            
            const blob = new Blob([conversation], { type: 'text/plain' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'consulta_trd_' + new Date().toISOString().slice(0, 10) + '.txt';
            a.click();
            URL.revokeObjectURL(url);
        }

        // Agregar bot√≥n de exportar conversaci√≥n
        function addExportButton() {
            const chatHeader = document.querySelector('.chat-header');
            const exportBtn = document.createElement('button');
            exportBtn.innerHTML = 'üíæ Exportar Conversaci√≥n';
            exportBtn.style.cssText = `
                position: absolute;
                top: 15px;
                right: 15px;
                padding: 8px 12px;
                background: rgba(255,255,255,0.2);
                color: white;
                border: 1px solid rgba(255,255,255,0.3);
                border-radius: 5px;
                cursor: pointer;
                font-size: 0.8rem;
            `;
            exportBtn.onclick = exportConversation;
            chatHeader.style.position = 'relative';
            chatHeader.appendChild(exportBtn);
        }

        // Inicializar funcionalidades adicionales
        window.addEventListener('load', () => {
            addExportButton();
            
            // Mensaje de bienvenida con delay
            setTimeout(() => {
                addMessage(`
                    <p><strong>üöÄ Sistema inicializado correctamente</strong></p>
                    <p>üìä <strong>Dataset cargado:</strong> 248 series documentales analizadas</p>
                    <p>üß† <strong>Modelo IA:</strong> GPT-4 con RAG optimizado para archiv√≠stica</p>
                    <p>üìñ <strong>Base normativa:</strong> Ley 594/2000, Acuerdo AGN 004/2019</p>
                    <p>¬°Estoy listo para responder tus consultas sobre TRD!</p>
                    <span class="confidence-indicator confidence-high">Sistema operativo</span>
                `, 'assistant');
            }, 2000);
        });

        // Funci√≥n para limpiar conversaci√≥n
        function clearChat() {
            const messagesContainer = document.getElementById('chatMessages');
            messagesContainer.innerHTML = `
                <div class="message assistant">
                    <div class="message-avatar">IA</div>
                    <div class="message-content">
                        <p>¬°Hola! Soy tu asistente para consultas sobre Tablas de Retenci√≥n Documental. Puedo ayudarte con:</p>
                        <ul style="margin: 10px 0; padding-left: 20px;">
                            <li>Buscar series y subseries documentales</li>
                            <li>Consultar tiempos de retenci√≥n</li>
                            <li>Verificar disposici√≥n final</li>
                            <li>Explicar normativa archiv√≠stica</li>
                        </ul>
                        <p>¬øEn qu√© puedo ayudarte hoy?</p>
                        <span class="confidence-indicator confidence-high">Sistema listo</span>
                    </div>
                </div>
            `;
            messageCount = 0;
        }

        // Agregar bot√≥n de limpiar conversaci√≥n
        function addClearButton() {
            const sidebar = document.querySelector('.sidebar');
            const clearPanel = document.createElement('div');
            clearPanel.className = 'panel';
            clearPanel.innerHTML = `
                <h3>üßπ Gesti√≥n de Sesi√≥n</h3>
                <div class="quick-actions">
                    <button class="action-btn" onclick="clearChat()" style="background: linear-gradient(45deg, #dc3545, #bd2130);">
                        üóëÔ∏è Limpiar Conversaci√≥n
                    </button>
                    <button class="action-btn" onclick="exportConversation()">
                        üíæ Exportar Consultas
                    </button>
                </div>
            `;
            sidebar.appendChild(clearPanel);
        }

        setTimeout(addClearButton, 1000);
    </script>
</body>
</html>
